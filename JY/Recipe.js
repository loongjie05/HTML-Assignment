let foods = [
    {
      title: "Nasi Lemak",
      img: "../street food/picture/NasiLemak1.webp",
      tags: ["Time: 1h 5 mins", "Spicy", "Malaysia"],
      link: "../street food/Food.html?page=1",
      continent: "Asia",
      type: "Rice",
      method: "Boiling",
      flavor: "Spicy"
    },
    {
      title: "Mango Sticky Rice",
      img: "../street food/picture/MangoRice1.jpg",
      tags: ["Time: 1h ", "Sweet", "Thailand"],
      link: "../street food/Food.html?page=2",
      continent: "Asia",
      type: "Rice",
      method: "Boiling",
      flavor: "Sweet"
    },
    {
      title: "Taco",
      img: "../street food/picture/Taco1.jpg",
      tags: ["Time: 35min", "Savory", "Mexico"],
      link: "../street food/Food.html?page=3",
      continent: "North America",
      type: "Bread",
      method: "Grilled",
      flavor: "Savory"
    },
    {
      title: "Churros",
      img: "../street food/picture/Churros1.webp",
      tags: ["Time: 25min", "Sweet", "Spain"],
      link: "../street food/Food.html?page=4",
      continent: "Europe",
      type: "Pastry",
      method: "Fried",
      flavor: "Sweet"
    },
    {
      title: "Bunny Chow",
      img: "../street food/picture/BunnyChow1.webp",
      tags: ["Time: 1h 10min", "Savory", "South Africa"],
      link: "../street food/Food.html?page=5",
      continent: "Africa",
      type: "Bread",
      method: "Baked",
      flavor: "Savory"
    },
    {
      title: "Meat Pie",
      img: "../street food/picture/MeatPie1.jpg",
      tags: ["Time: 1h", "Savory", "Australia"],
      link: "../street food/Food.html?page=6",
      continent: "Oceania",
      type: "Pastry",
      method: "Baked",
      flavor: "Savory"
    },
    {
      title: "Arepas",
      img: "../street food/picture/Arepas1.jpg",
      tags: ["Time: 40min", "Savory", "Venezuela"],
      link: "../street food/Food.html?page=7",
      continent: "South America",
      type: "Bread",
      method: "Grilled",
      flavor: "Savory"
    },
    {
      title: "Pad Thai",
      img: "../street food/picture/PadThai1.webp",
      tags: ["Time: 40min", "Savory", "Thailand"],
      link: "../street food/Food.html?page=8",
      continent: "Asia",
      type: "Noodles",
      method: "Fried",
      flavor: "Savory"
    },
    {
      title: "Falafel",
      img: "../street food/picture/Falafel1.jpg",
      tags: ["Time: 45min", "Savory", "Middle East"],
      link: "../street food/Food.html?page=9",
      continent: "Asia",
      type: "Snack",
      method: "Fried",
      flavor: "Savory"
    },
    {
      title: "Satay",
      img: "../street food/picture/Satay1.avif",
      tags: ["Time: 50min", "Savory", "Malaysia"],
      link: "../street food/Food.html?page=10",
      continent: "Asia",
      type: "Skewers",
      method: "Grilled",
      flavor: "Savory"
    },
    {
      title: "Poutine",
      img: "../street food/picture/Poutine1.jpg",
      tags: ["Time: 30min", "Savory", "Canada"],
      link: "../street food/Food.html?page=11",
      continent: "North America",
      type: "Snack",
      method: "Fried",
      flavor: "Savory"
    },
    {
      title: "Jerk Chicken",
      img: "../street food/picture/JerkChicken1.jpg",
      tags: ["Time: 1h 30min", "Spicy", "Jamaica"],
      link: "../street food/Food.html?page=12",
      continent: "North America",
      type: "Meat",
      method: "Grilled",
      flavor: "Spicy"
    },
    {
      title: "Takoyaki",
      img: "../street food/picture/Takoyaki1.avif",
      tags: ["Time: 40min", "Savory", "Japan"],
      link: "../street food/Food.html?page=13",
      continent: "Asia",
      type: "Snack",
      method: "Fried",
      flavor: "Savory"
    },
    {
      title: "Empanadas",
      img: "../street food/picture/Empanadas1.webp",
      tags: ["Time: 1h", "Savory", "Argentina"],
      link: "../street food/Food.html?page=14",
      continent: "South America",
      type: "Pastry",
      method: "Baked",
      flavor: "Savory"
    },
    {
      title: "Char Kway Teow",
      img: "../street food/picture/CharKwayTeow1.jpg",
      tags: ["Time: 25min", "Savory", "Malaysia"],
      link: "../street food/Food.html?page=15",
      continent: "Asia",
      type: "Noodles",
      method: "Stir-fried",
      flavor: "Savory"
    },
    {
      title: "Dumplings",
      img: "../street food/picture/Dumplings1.jpg",
      tags: ["Time: 45min", "Savory", "China"],
      link: "../street food/Food.html?page=16",
      continent: "Asia",
      type: "Dough",
      method: "Boiled/Fried",
      flavor: "Savory"
    },
    {
      title: "Baguette Sandwich",
      img: "../street food/picture/BaguetteSandwich1.jpg",
      tags: ["Time: 10min", "Savory", "France"],
      link: "../street food/Food.html?page=17",
      continent: "Europe",
      type: "Bread",
      method: "Fresh",
      flavor: "Savory"
    },
    {
      title: "Suya",
      img: "../street food/picture/Suya1.jpg",
      tags: ["Time: 50min", "Savory", "Nigeria"],
      link: "../street food/Food.html?page=18",
      continent: "Africa",
      type: "Skewers",
      method: "Grilled",
      flavor: "Savory"
    },
    {
      title: "Dagwood Dog",
      img: "../street food/picture/DagwoodDog1.jpg",
      tags: ["Time: 20min", "Savory", "Australia"],
      link: "../street food/Food.html?page=19",
      continent: "Oceania",
      type: "Snack",
      method: "Fried",
      flavor: "Savory"
    },
    {
      title: "Hamdog",
      img: "../street food/picture/Hamdog1.jpeg",
      tags: ["Time: 30min", "Savory", "Australia"],
      link: "../street food/Food.html?page=20",
      continent: "Oceania",
      type: "Snack",
      method: "Grilled",
      flavor: ["Savory", "Juicy"]
    },
    {
    title: "Laksa",
    img: "../street food/picture/Laksa1.jpg",
    tags: ["Time: 20-30min", "Spicy", "Malaysia"],
    link: "../street food/Food.html?page=21",
    continent: "Asia",
    type: "Noodles",
    method: "Boiled",
    flavor: "Spicy"
  },
  {
    title: "Roti Canai",
    img: "../street food/picture/RotiCanai1.jpg",
    tags: ["Time: 15min", "Savory", "Malaysia"],
    link: "../street food/Food.html?page=22",
    continent: "Asia",
    type: "Bread",
    method: "Pan-fried",
    flavor: "Savory"
  },
  {
    title: "Nasi Kandar",
    img: "../street food/picture/NasiKandar1.jpg",
    tags: ["Time: 30min", "Savory", "Malaysia"],
    link: "../street food/Food.html?page=23",
    continent: "Asia",
    type: "Rice",
    method: "Boiled/Steamed",
    flavor: "Savory"
  },
  {
    title: "Hokkien Mee",
    img: "../street food/picture/HokkienMee1.jpg",
    tags: ["Time: 25min", "Savory", "Malaysia"],
    link: "../street food/Food.html?page=24",
    continent: "Asia",
    type: "Noodles",
    method: "Stir-fried",
    flavor: "Savory"
  },
  {
    title: "Cendol",
    img: "../street food/picture/Cendol1.webp",
    tags: ["Time: 10min", "Sweet", "Malaysia"],
    link: "../street food/Food.html?page=25",
    continent: "Asia",
    type: "Dessert",
    method: "Assembled/Cold",
    flavor: "Sweet"
  },
  {
    title: "Asam Laksa",
    img: "../street food/picture/Laksa1.jpg",
    tags: ["Time: 25-30min", "Sour & Spicy", "Malaysia"],
    link: "../street food/Food.html?page=26",
    continent: "Asia",
    type: "Noodles",
    method: "Boiled",
    flavor: "Sour"
  },
  {
    title: "Nasi Kerabu",
    img: "../street food/picture/NasiKerabu1.jpg",
    tags: ["Time: 30min", "Savory", "Malaysia"],
    link: "../street food/Food.html?page=27",
    continent: "Asia",
    type: "Rice",
    method: "Boiled/Steamed",
    flavor: "Savory"
  },
  {
    title: "Rojak",
    img: "../street food/picture/Rojak1.jpg",
    tags: ["Time: 15min", "Sweet & Savory", "Malaysia"],
    link: "../street food/Food.html?page=28",
    continent: "Asia",
    type: "Salad",
    method: "Mixed/Assembled",
    flavor: "Savory"
  },
  {
    title: "Sushi",
    img: "../street food/picture/Sushi1.webp",
    tags: ["Time: 20min", "Savory", "Japan"],
    link: "../street food/Food.html?page=29",
    continent: "Asia",
    type: "Rice",
    method: "Raw",
    flavor: "Savory"
  },
  {
    title: "Biryani",
    img: "../street food/picture/Biryani1.jpg",
    tags: ["Time: 1hr", "Spiced", "India"],
    link: "../street food/Food.html?page=30",
    continent: "Asia",
    type: "Rice",
    method: "Steamed",
    flavor: "Spiced"
  },
  {
    title: "Pho",
    img: "../street food/picture/Pho1.webp",
    tags: ["Time: 2hr", "Savory", "Vietnam"],
    link: "../street food/Food.html?page=31",
    continent: "Asia",
    type: "Soup",
    method: "Boiled",
    flavor: "Savory"
  },
  {
    title: "Tom Yum",
    img: "../street food/picture/TomYum1.jpg",
    tags: ["Time: 40min", "Sour", "Thailand"],
    link: "../street food/Food.html?page=32",
    continent: "Asia",
    type: "Soup",
    method: "Boiled",
    flavor: "Sour"
  },
  {
    title: "Ramen",
    img: "../street food/picture/Ramen1.jpg",
    tags: ["Time: 45min", "Savory", "Japan"],
    link: "../street food/Food.html?page=33",
    continent: "Asia",
    type: "Noodles",
    method: "Boiled",
    flavor: "Savory"
  },
  {
    title: "Peking Duck",
    img: "../street food/picture/PekingDuck1.jpg",
    tags: ["Time: 2hr", "Savory", "China"],
    link: "../street food/Food.html?page=34",
    continent: "Asia",
    type: "Meat",
    method: "Roasted",
    flavor: "Savory"
  },
  {
    title: "Fish and Chips",
    img: "../street food/picture/FishAndChips1.webp",
    tags: ["Time: 30min", "Savory", "United Kingdom"],
    link: "../street food/Food.html?page=35",
    continent: "Europe",
    type: "Snack",
    method: "Fried",
    flavor: "Savory"
  },
  {
    title: "Paella",
    img: "../street food/picture/Paella1.jpg",
    tags: ["Time: 1hr", "Savory", "Spain"],
    link: "../street food/Food.html?page=36",
    continent: "Europe",
    type: "Rice",
    method: "Simmered",
    flavor: "Savory"
  },
  {
    title: "Pizza Margherita",
    img: "../street food/picture/PizzaMargherita1.webp",
    tags: ["Time: 40min", "Savory", "Italy"],
    link: "../street food/Food.html?page=37",
    continent: "Europe",
    type: "Bread",
    method: "Baked",
    flavor: "Savory"
  },
  {
    title: "Gyro",
    img: "../street food/picture/Gyro1.webp",
    tags: ["Time: 45min", "Savory", "Greece"],
    link: "../street food/Food.html?page=38",
    continent: "Europe",
    type: "Meat",
    method: "Grilled",
    flavor: "Savory"
  },
  {
    title: "Pierogi",
    img: "../street food/picture/Pierogi1.jpg",
    tags: ["Time: 50min", "Savory", "Poland"],
    link: "../street food/Food.html?page=39",
    continent: "Europe",
    type: "Dumpling",
    method: "Boiled/Fried",
    flavor: "Savory"
  },
  {
    title: "Goulash",
    img: "../street food/picture/Goulash1.jpg",
    tags: ["Time: 1hr 30min", "Savory", "Hungary"],
    link: "../street food/Food.html?page=40",
    continent: "Europe",
    type: "Stew",
    method: "Stewed",
    flavor: "Savory"
  },
  {
    title: "Bratwurst",
    img: "../street food/picture/Bratwurst1.jpg",
    tags: ["Time: 30min", "Savory", "Germany"],
    link: "../street food/Food.html?page=41",
    continent: "Europe",
    type: "Sausage",
    method: "Grilled",
    flavor: "Savory"
  },
  {
    title: "Crêpes",
    img: "../street food/picture/Crêpes1.jpg",
    tags: ["Time: 20min", "Sweet", "France"],
    link: "../street food/Food.html?page=42",
    continent: "Europe",
    type: "Pastry",
    method: "Pan-Fried",
    flavor: "Sweet"
  },
  {
    title: "Doner Kebab",
    img: "../street food/picture/DonerKebab1.jpg",
    tags: ["Time: 1hr", "Savory", "Turkey"],
    link: "../street food/Food.html?page=43",
    continent: "Europe",
    type: "Meat",
    method: "Roasted",
    flavor: "Savory"
  },
  {
    title: "Hamburger",
    img: "../street food/picture/Hamburger1.jpg",
    tags: ["Time: 25 mins", "Savory", "United States"],
    link: "../street food/Food.html?page=44",
    continent: "North America",
    type: "Sandwich",
    method: "Grilled",
    flavor: "Savory"
  },
  {
    title: "Hot Dog",
    img: "../street food/picture/HotDog1.jpg",
    tags: ["Time: 15 mins", "Savory", "United States"],
    link: "../street food/Food.html?page=45",
    continent: "North America",
    type: "Snack",
    method: "Boiled",
    flavor: "Savory"
  },
  {
    title: "Burrito",
    img: "../street food/picture/Burrito1.jpg",
    tags: ["Time: 30 mins", "Savory", "Mexico"],
    link: "../street food/Food.html?page=46",
    continent: "North America",
    type: "Wrap",
    method: "Wrapped",
    flavor: "Savory"
  },
  {
    title: "Nachos",
    img: "../street food/picture/Nachos1.jpg",
    tags: ["Time: 20 mins", "Savory", "Mexico"],
    link: "../street food/Food.html?page=47",
    continent: "North America",
    type: "Snack",
    method: "Baked",
    flavor: "Savory"
  },
  {
    title: "Clam Chowder",
    img: "../street food/picture/ClamChowder1.jpg",
    tags: ["Time: 1hr", "Savory", "United States"],
    link: "../street food/Food.html?page=48",
    continent: "North America",
    type: "Soup",
    method: "Simmered",
    flavor: "Savory"
  },
  {
    title: "Gumbo",
    img: "../street food/picture/Gumbo1.jpg",
    tags: ["Time: 1hr 30 mins", "Spicy", "United States"],
    link: "../street food/Food.html?page=49",
    continent: "North America",
    type: "Stew",
    method: "Simmered",
    flavor: "Spicy"
  },
  {
    title: "Buffalo Wings",
    img: "../street food/picture/BuffaloWings1.jpg",
    tags: ["Time: 40 mins", "Spicy", "United States"],
    link: "../street food/Food.html?page=50",
    continent: "North America",
    type: "Snack",
    method: "Fried",
    flavor: "Spicy"
  },
  {
    title: "Bagel with Lox",
    img: "../street food/picture/BagelLox1.jpg",
    tags: ["Time: 15 mins", "Savory", "United States"],
    link: "../street food/Food.html?page=51",
    continent: "North America",
    type: "Bread",
    method: "Assembled",
    flavor: "Savory"
  },
  {
    title: "Philly Cheesesteak",
    img: "../street food/picture/PhillyCheesesteak1.webp",
    tags: ["Time: 35 mins", "Savory", "United States"],
    link: "../street food/Food.html?page=52",
    continent: "North America",
    type: "Sandwich",
    method: "Grilled",
    flavor: "Savory"
  },
  {
    title: "Feijoada",
    img: "../street food/picture/Feijoada1.jpg",
    tags: ["Time: 2hr", "Savory", "Brazil"],
    link: "../street food/Food.html?page=53",
    continent: "South America",
    type: "Stew",
    method: "Boiled",
    flavor: "Savory"
  },
  {
    title: "Asado",
    img: "../street food/picture/Asado1.jpg",
    tags: ["Time: 3hr", "Savory", "Argentina"],
    link: "../street food/Food.html?page=54",
    continent: "South America",
    type: "BBQ",
    method: "Grilled",
    flavor: "Savory"
  },
  {
    title: "Ceviche",
    img: "../street food/picture/Ceviche1.jpg",
    tags: ["Time: 1hr", "Tangy", "Peru"],
    link: "../street food/Food.html?page=55",
    continent: "South America",
    type: "Seafood",
    method: "Cured",
    flavor: "Tangy"
  },
  {
    title: "Pão de Queijo",
    img: "../street food/picture/PaoDeQueijo1.jpg",
    tags: ["Time: 1hr", "Savory", "Brazil"],
    link: "../street food/Food.html?page=56",
    continent: "South America",
    type: "Bread",
    method: "Baked",
    flavor: "Savory"
  },
  {
    title: "Churrasco",
    img: "../street food/picture/Churrasco1.jpg",
    tags: ["Time: 2hr", "Savory", "Brazil"],
    link: "../street food/Food.html?page=57",
    continent: "South America",
    type: "BBQ",
    method: "Grilled",
    flavor: "Savory"
  },
  {
    title: "Choripán",
    img: "../street food/picture/Choripan1.jpg",
    tags: ["Time: 30min", "Savory", "Argentina"],
    link: "../street food/Food.html?page=58",
    continent: "South America",
    type: "Sandwich",
    method: "Grilled",
    flavor: "Savory"
  },
  {
    title: "Moqueca",
    img: "../street food/picture/Moqueca1.jpg",
    tags: ["Time: 2hr", "Savory", "Brazil"],
    link: "../street food/Food.html?page=59",
    continent: "South America",
    type: "Stew",
    method: "Simmered",
    flavor: "Savory"
  },
  {
    title: "Ajiaco",
    img: "../street food/picture/Ajiaco1.jpg",
    tags: ["Time: 2hr", "Savory", "Colombia"],
    link: "../street food/Food.html?page=60",
    continent: "South America",
    type: "Soup",
    method: "Boiled",
    flavor: "Savory"
  },
  {
    title: "Jollof Rice",
    img: "../street food/picture/JollofRice1.jpg",
    tags: ["Time: 1hr", "Savory", "West Africa"],
    link: "../street food/Food.html?page=61",
    continent: "Africa",
    type: "Rice",
    method: "Steamed",
    flavor: "Savory"
  },
  {
    title: "Bobotie",
    img: "../street food/picture/Bobotie1.jpg",
    tags: ["Time: 1.5hr", "Savory", "South Africa"],
    link: "../street food/Food.html?page=62",
    continent: "Africa",
    type: "Baked",
    method: "Baked",
    flavor: "Savory"
  },
  {
    title: "Tagine",
    img: "../street food/picture/Tagine1.jpeg",
    tags: ["Time: 2hr", "Savory", "Morocco"],
    link: "../street food/Food.html?page=63",
    continent: "Africa",
    type: "Stew",
    method: "Stewed",
    flavor: "Savory"
  },
  {
    title: "Injera with Doro Wat",
    img: "../street food/picture/Injera1.jpg",
    tags: ["Time: 2hr", "Spicy", "Ethiopia"],
    link: "../street food/Food.html?page=64",
    continent: "Africa",
    type: "Stew",
    method: "Stewed",
    flavor: "Spicy"
  },
  {
    title: "Koshari",
    img: "../street food/picture/Koshari1.jpg",
    tags: ["Time: 1hr", "Savory", "Egypt"],
    link: "../street food/Food.html?page=65",
    continent: "Africa",
    type: "Rice/Pasta",
    method: "Mixed",
    flavor: "Savory"
  },
  {
    title: "Suya",
    img: "../street food/picture/Suya1.jpg",
    tags: ["Time: 45min", "Spicy", "Nigeria"],
    link: "../street food/Food.html?page=66",
    continent: "Africa",
    type: "Skewers",
    method: "Grilled",
    flavor: "Spicy"
  },
  {
    title: "Nyama Choma",
    img: "../street food/picture/NyamaChoma1.png",
    tags: ["Time: 1hr", "Savory", "Kenya"],
    link: "../street food/Food.html?page=67",
    continent: "Africa",
    type: "BBQ",
    method: "Grilled",
    flavor: "Savory"
  },
  {
    title: "Shakshuka",
    img: "../street food/picture/Shakshuka1.jpg",
    tags: ["Time: 40min", "Savory", "Tunisia"],
    link: "../street food/Food.html?page=68",
    continent: "Africa",
    type: "Egg",
    method: "Poached",
    flavor: "Savory"
  },
  {
    title: "Lamingtons",
    img: "../street food/picture/Lamingtons1.jpg",
    tags: ["Time: 1hr", "Sweet", "Australia"],
    link: "../street food/Food.html?page=69",
    continent: "Oceania",
    type: "Cake",
    method: "Baked",
    flavor: "Sweet"
  },
  {
    title: "Pavlova",
    img: "../street food/picture/Pavlova1.jpg",
    tags: ["Time: 2hr", "Sweet", "New Zealand"],
    link: "../street food/Food.html?page=70",
    continent: "Oceania",
    type: "Dessert",
    method: "Baked",
    flavor: "Sweet"
  },
  {
    title: "Sausage Sizzle",
    img: "../street food/picture/SausageSizzle1.jpg",
    tags: ["Time: 30min", "Savory", "Australia"],
    link: "../street food/Food.html?page=71",
    continent: "Oceania",
    type: "Snack",
    method: "Grilled",
    flavor: "Savory"
  },
  {
    title: "Chiko Roll",
    img: "../street food/picture/ChikoRoll1.jpg",
    tags: ["Time: 1hr", "Savory", "Australia"],
    link: "../street food/Food.html?page=72",
    continent: "Oceania",
    type: "Snack",
    method: "Fried",
    flavor: "Savory"
  },
  {
    title: "Barramundi",
    img: "../street food/picture/Barramundi1.webp",
    tags: ["Time: 40min", "Savory", "Australia"],
    link: "../street food/Food.html?page=73",
    continent: "Oceania",
    type: "Fish",
    method: "Grilled",
    flavor: "Savory"
  },
  {
    title: "Kangaroo Steak",
    img: "../street food/picture/KangarooSteak1.jpg",
    tags: ["Time: 45min", "Savory", "Australia"],
    link: "../street food/Food.html?page=74",
    continent: "Oceania",
    type: "Meat",
    method: "Grilled",
    flavor: "Savory"
  },
  {
    title: "Fairy Bread",
    img: "../street food/picture/FairyBread1.jpg",
    tags: ["Time: 10min", "Sweet", "Australia"],
    link: "../street food/Food.html?page=75",
    continent: "Oceania",
    type: "Snack",
    method: "No-cook",
    flavor: "Sweet"
  }
];

/* Merge shared dataset foods to display all items */
(function(){
  try {
    const siteFoods = (window.SiteData && Array.isArray(window.SiteData.foods)) ? window.SiteData.foods : [];
    if (!siteFoods.length) return;
    const byTitle = new Map(foods.map(f => [f.title, f]));
    const mapped = siteFoods.map(item => {
      const existing = byTitle.get(item.title);
      if (existing) return existing;
      const fallbackLink = `../street food/Food.html?title=${encodeURIComponent(item.title)}`;
      return {
        title: item.title,
        img: (item.images && item.images.cover) || '../LJ/pictures/cooking.jpg',
        tags: [
          'Time: 45min',
          (String(item.description || '').toLowerCase().includes('sweet') ? 'Sweet' : 'Savory'),
          item.country || item.continent || ''
        ],
        link: fallbackLink,
        continent: item.continent || '',
        type: item.type || 'Snack',
        method: 'Various',
        flavor: (String(item.description || '').toLowerCase().includes('sweet') ? 'Sweet' : 'Savory')
      };
    });
    mapped.forEach(m => { if (!byTitle.has(m.title)) byTitle.set(m.title, m); });
    foods = Array.from(byTitle.values());
  } catch(e) { /* ignore */ }
})();

/* If opened with ?food=Name, redirect to the individual street food page */
(function(){
  try {
    const params = new URLSearchParams(window.location.search);
    const foodParam = params.get('food');
    if (foodParam) {
      const match = foods.find(f => (f.title || '').toLowerCase() === foodParam.toLowerCase());
      if (match && match.link) {
        const a = document.createElement('a');
        a.href = match.link;
        const targetPath = a.pathname.replace(/\\/g,'/');
        const currentPath = location.pathname.replace(/\\/g,'/');
        if (targetPath !== currentPath && !/Recipe\.html$/i.test(targetPath)) {
          window.location.replace(match.link);
          return;
        }
      }
    }
  } catch (e) {}
})();

function populateCustomSelect(id, items, allLabel) {
  const container = document.querySelector(`#${id} .select-items`);
  container.innerHTML = "";

  const allDiv = document.createElement("div");
  allDiv.textContent = allLabel;
  allDiv.dataset.value = "";
  container.appendChild(allDiv);

  items.forEach(item => {
    const div = document.createElement("div");
    div.textContent = item;
    div.dataset.value = item;
    container.appendChild(div);
  });
}

const continents = [...new Set(foods.map(f => f.continent))].sort();
const methods = [...new Set(foods.map(f => f.method))].sort();
const flavors = [...new Set(foods.map(f => f.flavor))].sort();
const types = [...new Set(foods.map(f => f.type))].sort();

populateCustomSelect("filterContinents", continents, "Continents");
populateCustomSelect("filterMethod", methods, "Cooking Methods");
populateCustomSelect("filterFlavor", flavors, "Flavors");
populateCustomSelect("filterType", types, "Types");

function bindSelectEvents() {
  document.querySelectorAll(".custom-select").forEach(select => {
    const selected = select.querySelector(".select-selected");
    const items = select.querySelector(".select-items");

    select.addEventListener("mouseenter", () => select.classList.add("open"));
    select.addEventListener("mouseleave", () => select.classList.remove("open"));

    items.querySelectorAll("div").forEach(option => {
      option.addEventListener("click", () => {
        selected.textContent = option.textContent;
        select.classList.remove("open");
        filterCards();
      });
    });
  });
}
bindSelectEvents();

const container = document.getElementById("cardContainer");
const searchInput = document.querySelector(".searchInput");
const searchSuggestions = document.getElementById("searchSuggestions");

/* Autocomplete functionality */
function showSearchSuggestions(query) {
  if (!query.trim()) {
    searchSuggestions.style.display = 'none';
    return;
  }

  const suggestions = foods
    .filter(food => food.title.toLowerCase().includes(query.toLowerCase()))
    .slice(0, 8);

  if (suggestions.length === 0) {
    searchSuggestions.style.display = 'none';
    return;
  }

  searchSuggestions.innerHTML = suggestions.map(food => `
    <div class="search-suggestion-item" data-title="${food.title}">
      <img src="${food.img}" alt="${food.title}" class="food-image" onerror="this.src='../LJ/pictures/cooking.jpg'">
      <div class="food-info">
        <div class="food-name">${food.title}</div>
        <div class="food-meta">
          <span class="food-country">${food.tags[2] || ''}</span> • ${food.type} • ${food.method}
        </div>
      </div>
    </div>
  `).join('');

  searchSuggestions.style.display = 'block';

  searchSuggestions.querySelectorAll('.search-suggestion-item').forEach(item => {
    item.addEventListener('click', () => {
      const title = item.dataset.title;
      searchInput.value = title;
      searchSuggestions.style.display = 'none';
      filterCards();
    });
  });
}

/* Hide suggestions when clicking outside */
document.addEventListener('click', (e) => {
  if (!e.target.closest('.search-wrapper')) {
    searchSuggestions.style.display = 'none';
  }
});

/* Show suggestions on input */
searchInput.addEventListener('input', (e) => {
  showSearchSuggestions(e.target.value);
  filterCards();
});

/* Show suggestions on focus if there's text */
searchInput.addEventListener('focus', () => {
  if (searchInput.value.trim()) showSearchSuggestions(searchInput.value);
});

function renderCards(list) {
  const container = document.getElementById("cardContainer");
  container.innerHTML = "";

  list.forEach(food => {
    const card = document.createElement("article");
    card.className = "article-wrapper";

    card.innerHTML = `
      <div class="container-project" style="background-image: url('${food.img}');">
        <span class="fav-heart" data-title="${food.title.replace(/"/g,'&quot;')}" title="Toggle favourite" aria-label="Toggle favourite">
          <i class="fa-solid fa-heart"></i>
        </span>
      </div>
      <div class="project-info">
        <div class="flex-pr">
          <div class="project-title text-nowrap">${food.title}</div>
          <div class="project-hover">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" stroke-linejoin="round" stroke-linecap="round" viewBox="0 0 24 24" stroke-width="2" fill="none" stroke="currentColor">
              <line y2="12" x2="19" y1="12" x1="5"></line>
              <polyline points="12 5 19 12 12 19"></polyline>
            </svg>
          </div>
        </div>
        <div class="types">
          ${food.tags.map(t => `<span class="project-type">• ${t}</span>`).join('')}
        </div>
      </div>
    `;

    card.addEventListener("click", (e) => {
      if (e.target.closest('.fav-heart')) return;
      window.location.href = food.link;
    });

    // Favourite heart toggle
    const heart = card.querySelector('.container-project .fav-heart');
    const title = food.title;
    const getFavs = () => { try { return JSON.parse(localStorage.getItem('favourites') || '[]'); } catch(e){ return []; } };
    const setFavs = (arr) => localStorage.setItem('favourites', JSON.stringify(arr));
    const updateUi = () => {
      const favs = getFavs();
      if (favs.includes(title)) heart.classList.add('saved'); else heart.classList.remove('saved');
    };
    updateUi();
    heart.addEventListener('click', (e) => {
      e.stopPropagation();
      const favs = getFavs();
      const idx = favs.indexOf(title);
      if (idx === -1) favs.push(title); else favs.splice(idx, 1);
      setFavs(favs);
      updateUi();
    });

    container.appendChild(card);
  });
}

function filterCards() {
  const searchVal = searchInput.value.toLowerCase();
  const continentVal = document.querySelector("#filterContinents .select-selected").textContent;
  const methodVal = document.querySelector("#filterMethod .select-selected").textContent;
  const flavorVal = document.querySelector("#filterFlavor .select-selected").textContent;
  const typeVal = document.querySelector("#filterType .select-selected").textContent;

  const filtered = foods.filter(food => {
    const matchSearch = food.title.toLowerCase().includes(searchVal);
    const matchContinent = continentVal === "Continents" || food.continent === continentVal;
    const matchMethod = methodVal === "Cooking Methods" || food.method === methodVal;
    const matchFlavor = flavorVal === "Flavors" || food.flavor === flavorVal;
    const matchType = typeVal === "Types" || food.type === typeVal;

    return matchSearch && matchContinent && matchMethod && matchFlavor && matchType;
  });

  renderCards(filtered);
}

function clearSearch() {
  searchInput.value = "";
  searchSuggestions.style.display = 'none';
  filterCards();
}

renderCards(foods);
